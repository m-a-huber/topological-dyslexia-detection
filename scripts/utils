import numpy as np
from sklearn.base import (  # type: ignore  # type: ignore
    BaseEstimator,
    TransformerMixin,
)
from sklearn.preprocessing import (  # type: ignore
    MinMaxScaler,
    StandardScaler,
)


class TimeSeriesScaler(BaseEstimator, TransformerMixin):
    def __init__(self, scaler=None):
        self.scaler = scaler if scaler is not None else StandardScaler()

    def fit(self, X, y=None):
        all_points = np.concatenate(X)
        self.scaler.fit(all_points)
        return self

    def transform(self, X):
        return [self.scaler.transform(cloud) for cloud in X]


class PersistenceImageScaler(BaseEstimator, TransformerMixin):
    def __init__(self, scaler=None):
        self.scaler = scaler if scaler is not None else MinMaxScaler()

    def fit(self, X, y=None):
        self.scaler.fit(X.T)
        return self

    def transform(self, X):
        return self.scaler.fit_transform(X.T).T
